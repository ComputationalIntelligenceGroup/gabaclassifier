---
title: "GABAergic interneurons classifier"
author: "Bojan Mihaljevic"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Overview 

`gabaclassifier` classifies a given neuronal morphology into one of **eight** types, such as Chandelier or Martinotti. The following classifies cell C030502A as a nest basket cell.

```{r, message=FALSE}
library(gabaclassifier) 
file <- system.file('extdata', 'C030502A.swc', package = 'gabaclassifier')
classify_interneuron(file = file, layer  = '23')
```

The mapping from the abbreviated output to the full type name is 
```{r} 
# full_class_name('NBC')
```
names. have it somewhere for sure.
  
# Usage
Cells are classified with the `classify_interneuron` function. The inputs are

- A path to a SWC reconstruction of a neuron morphology
- The layer containing that cell  

The model has only been trained with layer L2/3 to layer L6 interneurons and thus interneurons from those layers are allowed as input to `classify_interneuron`.  
```{r}
# show error Try with l1. 
```
 
The output is one of the following type labels:
```{r}
# do this code inlune 
```
Chandelier, Martinotti, ...  It is simple to use.  **With function and abbrevs**   

# Details  
The class if classified into on of the following types. That is, considered the most likely out of those.  The layer information corresponds to male rat ... somatosensory cortex.  It is important that the morphology is of sufficient quality, as `gabaclassifier` performs only basic checks. Not all morphologies are valid and basic checks are performed.  If it is not indeed an interneuron, and so on. Checks:  has axon and dendrites, attached to soma, length > 3000 and so on. Both at training and clasification.

```{r}

```
 
  
# Model 

X.. cells from L23 to L6...

A random forest trained on **650** ...  The cells were classified into Ch, MC, by the Markam laboratory. 

- length? flat z? repetitions? 
- check apical? makes any sense? 
- minimum number of dendrites? that soma is present? 

An one-versus-all combination of random forest models provides somewhat better models for under-represented types. The accuracy is 72%. **Show the confusion matrix.**
The data and model building is explained in paper...Try oversampling? Not easy in multiclass.  No feature selection currently (OK with random forest).    
The ids of the cells are provided in ...

